<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Segoe UI', sans-serif;
  background: #ddad75;
  padding: 30px;
  color: #27211c;
}

/* ===== LOGIN ===== */
#loginBox {
  max-width: 700px;
  margin: 120px auto;
  background: #fff;
  padding: 60px;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}
#loginBox h2 {
  color: #ff6a00;
  margin-bottom: 20px;
  font-size: 50px;
}
input, select {
  width: 100%;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 8px;
  border: 1px solid #ddd;
}

/* ===== DASHBOARD ===== */
#dashboard {
  display: none;
  max-width: 1200px;
  margin: auto;
}

/* ===== TOP BAR ===== */
.top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}
.top-bar h1 {
  color: #f3f2eb;
}
.logout-btn {
  background: #111;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
}

/* ===== STATS ===== */
.stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 30px;
}
.stat-card {
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.08);
}
.stat-card h3 {
  color: #eb890a;
  font-size: 28px;
}
.stat-card p {
  color: #777;
}

/* ===== MAIN GRID ===== */
.main {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 30px;
}

/* ===== EMPLOYEE LIST ===== */
.employee-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 20px;
}
.employee-card {
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.08);
}
.employee-card h3 {
  color: #f5f2ef;
}
.employee-card p {
  font-size: 0.9rem;
  color: #555;
}
.actions {
  margin-top: 12px;
}
button {
  padding: 8px 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}
.edit-btn { background: #ff8c1a; color: white; }
.remove-btn { background: #ef4444; color: white; }

/* ===== FORM ===== */
.form-box {
  background: rgb(238, 127, 36);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.08);
}
.form-box h2 {
  margin-bottom: 15px;
  color: #ece6e2;
}
.save-btn {
  background: linear-gradient(135deg, #ff8c1a, #ff6a00);
  color: white;
  width: 100%;
  padding: 12px;
  border-radius: 10px;
}

/* ===== ACTIVITY ===== */
.activity {
  margin-top: 30px;
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.08);
}
.activity ul {
  list-style: none;
  margin-top: 10px;
}
.activity li {
  font-size: 0.85rem;
  color: #555;
  margin-bottom: 6px;
}
</style>
</head>

<body>

<!-- ===== LOGIN ===== -->
<div id="loginBox">
  <h2>Hello Maya Hive Admin</h2>
  <h3>Sign In</h3>
  <input id="email" placeholder="Admin Email">
  <input id="password" type="password" placeholder="Password">
  <button class="save-btn" onclick="login()">Login</button>
  <p id="error" style="color:red;"></p>
</div>

<!-- ===== DASHBOARD ===== -->
<div id="dashboard">

  <div class="top-bar">
    <h1>Maya Hive Admin Dashboard</h1>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>

  <!-- STATS -->
  <div class="stats">
    <div class="stat-card">
      <h3 id="totalEmployees">0</h3>
      <p>Total Employees</p>
    </div>
    <div class="stat-card">
      <h3 id="lastAction">â€”</h3>
      <p>Last Action</p>
    </div>
    <div class="stat-card">
      <h3>Admin</h3>
      <p>Role</p>
    </div>
  </div>

  <div class="main">

    <!-- EMPLOYEES -->
    <div class="employee-grid" id="employeeGrid"></div>

    <!-- ADD / EDIT -->
    <div class="form-box">
      <h2>Add / Edit Employee</h2>
      <input id="empId" disabled placeholder="Employee ID">
      <input id="empName" placeholder="Name">
      <input id="empEmail" placeholder="Email">
      <input id="empPhone" placeholder="Phone">
      <select id="empDepartment">
        <option value="">Select Department</option>
        <option>Engineering</option>
        <option>Sales</option>
        <option>Marketing</option>
        <option>HR</option>
      </select>
      <button class="save-btn" onclick="saveEmployee()">Save</button>
    </div>

  </div>

  <!-- ACTIVITY LOG -->
  <div class="activity">
    <h2>Activity Log</h2>
    <ul id="activityLog"></ul>
  </div>

</div>

<script>
const API = "https://employeemanagement-production-a990.up.railway.app";

/* ===== AUTH ===== */
function login() {
  if (email.value === "admin@maya.com" && password.value === "1234") {
    localStorage.setItem("admin", "true");
    showDashboard();
    log("Admin logged in");
  } else {
    error.innerText = "Invalid admin credentials";
  }
}
function logout() {
  localStorage.removeItem("admin");
  location.reload();
}
if (localStorage.getItem("admin")) showDashboard();

function showDashboard() {
  loginBox.style.display = "none";
  dashboard.style.display = "block";
  loadEmployees();
}

/* ===== ACTIVITY ===== */
function log(msg) {
  const time = new Date().toLocaleString();
  activityLog.innerHTML = `<li>[${time}] ${msg}</li>` + activityLog.innerHTML;
  lastAction.innerText = msg;
}

/* ===== LOAD ===== */
async function loadEmployees() {
  const res = await fetch(`${API}/employees`);
  const data = await res.json();
  employeeGrid.innerHTML = "";
  totalEmployees.innerText = data.data.length;

  data.data.forEach(emp => {
    employeeGrid.innerHTML += `
      <div class="employee-card">
        <h3>${emp.name}</h3>
        <p>${emp.email}</p>
        <p>${emp.phone}</p>
        <p>${emp.department}</p>
        <div class="actions">
          <button class="edit-btn" onclick="editEmployee('${emp._id}','${emp.name}','${emp.email}','${emp.phone}','${emp.department}')">Edit</button>
          <button class="remove-btn" onclick="removeEmployee('${emp._id}')">Remove</button>
        </div>
      </div>
    `;
  });
}

/* ===== ADD / EDIT ===== */
function editEmployee(id,name,email,phone,dept){
  empId.value = id;
  empName.value = name;
  empEmail.value = email;
  empPhone.value = phone;
  empDepartment.value = dept;
}

async function saveEmployee(){
  const payload = {
    name: empName.value,
    email: empEmail.value,
    phone: empPhone.value,
    department: empDepartment.value
  };

  if (empId.value) {
    await fetch(`${API}/employees/${empId.value}`, {
      method: "PUT",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload)
    });
    log("Employee updated");
  } else {
    await fetch(`${API}/employees`, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload)
    });
    log("New employee added");
  }

  empId.value = empName.value = empEmail.value = empPhone.value = "";
  loadEmployees();
}

/* ===== REMOVE ===== */
async function removeEmployee(id){
  if(!confirm("Remove employee?")) return;
  await fetch(`${API}/employees/${id}`, {method:"DELETE"});
  log("Employee removed");
  loadEmployees();
}
</script>

</body>
</html>
